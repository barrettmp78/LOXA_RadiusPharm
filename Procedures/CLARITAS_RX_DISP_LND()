CREATE OR REPLACE PROCEDURE "CLARITAS_RX_DISP_LND"()
  RETURNS VARCHAR(16777216)
  LANGUAGE SQL
  EXECUTE AS OWNER
AS
$$
DECLARE
  select_statement VARCHAR;
BEGIN
  -- Delete existing data
  DELETE FROM CLARITAS_RX_DISP_LND;

  -- Copy new data from stage into the table
  COPY INTO CLARITAS_RX_DISP_LND
  FROM @RADIUS_COMM.LND.RADIUS_LAKE_STG_CLARITAS
  PATTERN = '.*crx_dispense_202410.*'
  FILE_FORMAT = RADIUS_COMM.LND.CSV_FORMAT_PIPE_W_HDR
  FORCE = TRUE;

END;
$$;
